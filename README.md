# Final Assignment - CD
## Setup of the Flask application and the GitHub Actions workflow
Since the complexity of the Flask application was not relevant to this assignment, I decided to build a basic application based on the example found on [the Flask quickstart page](https://flask.palletsprojects.com/en/2.0.x/quickstart/). The first step was to create the view functions, tests for these functions and a workflow to run these tests. Next, I copied the repository to the target folder on my VPS and set up the configuration of Gunicorn and Nginx. After that, I generated SSH keys and added the public version as a deploy key to my GitHub repository. The private version was saved as a secret (SSH_KEY) along with other confidential information (SSH_USERNAME and SSH_HOST). Finally, I edited the workflow in order to include the actual deployment of any updates to the VPS. This happens in such a way that deployment is only possible if the tests have run successfully. In this case, the workflow logs into the VPS using the earlier mentioned secret variables. It then enters the target folder, pulls in the latest changes from the main branch using git and restarts the Flask application using systemctl. 
## Problems
### SSH authentication
During the initial run of the complete workflow (build and deploy), I got the error "ssh: handshake failed: ssh: unable to authenticate, attempted methods [none publickey], no supported methods remain". Apparently, this happened because I only stored the part between '-----BEGIN OPENSSH PRIVATE KEY-----' and '-----END OPENSSH PRIVATE KEY-----' in the .ssh/id_rsa file as a secret variable. After updating this variable by storing the entire content of the .ssh/id_rsa file, the workflow started running successfully.
### Configuring Gunicorn
When I tried to enable and start the service for the Flask application using systemctl, Gunicorn didn't start, because it failed with the result 'exit-code'. It turned out that I needed to stop the service for another Flask application (the farm site) I was running on the VPS. After doing this, I had no problems with starting the application.
### Warning concerning pip version
During the 'Setup Python' phase of the workflow, the error message 'Error: WARNING: You are using pip version 21.1.1; however, version 21.1.3 is available' appeared, although the workflow ran successfully. To get rid of this message, I decided to modify the desired Python version to just '3.9' instead of '3.9.5'. This solved the problem entirely.
